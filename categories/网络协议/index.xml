<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>网络协议 on 树深时间录</title><link>https://isshe.site/categories/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/</link><description>Recent content in 网络协议 on 树深时间录</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 16 Oct 2022 12:00:00 +0800</lastBuildDate><atom:link href="https://isshe.site/categories/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/index.xml" rel="self" type="application/rss+xml"/><item><title>VLAN 介绍</title><link>https://isshe.site/p/vlan-%E4%BB%8B%E7%BB%8D/</link><pubDate>Sun, 16 Oct 2022 12:00:00 +0800</pubDate><guid>https://isshe.site/p/vlan-%E4%BB%8B%E7%BB%8D/</guid><description>VLAN VLAN - 虚拟局域网（Virtual Local Area Network）。 在 IEEE 802.1Q 中，给定以太网上的最大 VLAN 数为 4094。（12 位 VID。减去头尾的 0 和 4095）
作用 VLAN 可以为网络提供以下作用： 广播控制 带宽利用 降低延迟 安全性（非设计作用，本身功能所附加出的） 采用虚拟局域网技术实现交换机以太网的广播隔离。 一个 VLAN 相当于 OSI 模型第 2 层的广播域，它能将广播控制在一个 VLAN 内部。 不同 VLAN 之间或 VLAN 与 LAN/WAN 的数据通信必须通过第 3 层（网络层）完成。 原理（划分方式） 物理层 (physical layer) 以交换机端口作为划分 VLAN 的基础。 适合规模不大的组织。 数据链路层 (data link layer) 以每台主机的MAC地址作为划分 VLAN 的基础。 实现方法： 创建一个 MAC 与 VLAN 映射的数据库。 当网络设备连接到端口后，交换机向VMPS(VLAN管理策略服务器)请求这个数据库。 找到相应的映射，完成 VLAN 的分配。 优点： 计算机物理位置的不同，也不影响 VLAN 的运作。 缺点： 人为建立 MAC 与 VLAN 的映射关系；因此导致管理复杂度增加。 网络层 以IP地址作为划分 VLAN 的基础；以子网视为 VLAN 设置的依据。【？？？】 优点： 网管人员已经将内部网段做好规划与分配后，将可大辐降低规划并设置 VLANs 架构的复杂度。 缺点： 交换机需要对帧进行处理（原本不需要），降低交换机接收和分派分组的效率。</description></item><item><title>网络协议 —— ARP</title><link>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-arp/</link><pubDate>Sun, 16 Oct 2022 12:00:00 +0800</pubDate><guid>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-arp/</guid><description>ARP 协议 ARP（Address Resolution Protocol）：地址解析协议，是根据 IP 地址获取物理地址的一个 TCP/IP 协议。
工作过程 当主机 A 要与主机 B 通信时，地址解析协议可以将主机 B 的 IP 地址解析成主机 B 的 MAC 地址 (如果 A/B 不同网段，则 A 解析的应该是下一跳的 MAC 地址)，以下为工作流程：
第 1 步：主机 A 根据路由表内容，确定用于访问主机 B 的转发 IP 地址。主机 A 在本地 ARP 缓存中查找与主机 B 的 IP 匹配 MAC 地址。 第 2 步：如果主机 A 没有找到映射，则将 ARP 请求帧广播到本地网络上的所有主机。 收到请求的主机检查自己的 IP 是否匹配，不匹配就丢弃此 ARP 请求。 第 3 步：主机 B 确定 ARP 请求中的 IP 地址与自己的 IP 地址匹配，则将主机 A 的 IP 地址和 MAC 地址映射添加到本地 ARP 缓存中。 第 4 步：主机 B 将包含其 MAC 地址的 ARP 回复消息直接发送回主机 A。 第 5 步：当主机 A 收到从主机 B 发来的 ARP 回复消息时，会用主机 B 的 IP 和 MAC 地址映射更新 ARP 缓存。本机缓存是有生存期的，生存期结束后，将再次重复上面的过程。主机 B 的 MAC 地址一旦确定，主机 A 就能向主机 B 发送 IP 通信了。 问题 什么是 ARP 欺骗？ 地址解析协议是建立在网络中各个主机可互相信任的基础上的，收到应答报文的主机，不会校验报文的真实性，就会加到 ARP 缓存中。 由此，攻击者可以向某一主机发送伪 ARP 应答报文，使此主机发送的信息无法到达预期的主机或者到达错误的主机，这就是 ARP 欺骗。</description></item><item><title>网络协议 —— DHCP</title><link>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-dhcp/</link><pubDate>Sun, 16 Oct 2022 12:00:00 +0800</pubDate><guid>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-dhcp/</guid><description>DHCP DHCP - 动态主机设置协议（Dynamic Host Configuration Protocol）。 DHCP 是一个应用层协议。基于UDP。
作用 用于内网或网络服务供应商自动分配 IP 给用户。 作为内部管理员对所有计算机进行中央管理的手段。 历史 DHCP 在 1993 年 10 月成为标准协议，它的前身是BOOTP协议。 BOOTP：BOOTP 是一种网络协议，让电脑或其他周边仪器可以从服务器下载启动程序。 数据包类型 DHCP 发现（DISCOVER）：client 在物理子网上发送广播来寻找可用的服务器。 DHCP 提供（OFFER）：当 DHCP 服务器收到一个来自客户的 IP 租约请求时，它会提供一个 IP 租约。 DHCP 请求（REQUEST）：当客户 PC 收到一个 IP 租约提供时，它必须告诉所有其他的 DHCP 服务器它已经接受了一个租约提供。 DHCP 确认（Acknowledge，ACK）：确认租约，包含租期和客户可能请求的其他所有配置信息。 DHCP 释放 (RELEASE)：客户端向 DHCP 服务器发送一个请求以释放 DHCP 资源，并注销其 IP 地址。 DHCP NAK：服务器回复客户，客户要求的网址不能被分配。 原理/流程 客户主机发送 DHCP 服务器发现 (DISCOVER)广播包。 服务器收到 DISCOVER 包后，回复OFFER单播或广播包。【疑问？】 客户主机收到 OFFER 包后，发送REQUEST广播包。 服务器回复ACK单播或广播包。包含分配的 IP 及网关 IP(next server IP)、租约等。 典型 DHCP 会话的模式</description></item><item><title>网络协议 —— DNS</title><link>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-dns/</link><pubDate>Sun, 16 Oct 2022 12:00:00 +0800</pubDate><guid>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-dns/</guid><description>DNS DNS - 域名系统（Domain Name System）。
是一个将域名和IP地址进行映射的分布式数据库。 DNS 是应用层协议，使用 TCP 和 UDP 的 53 端口。 每一级域名长度的限制是 63 个字符，域名总长度不能超过 253 个字符。 作用 将对人友好的域名转换为对计算机友好的 IP 地址。 原理/过程 域名层级
主机名.次级域名.顶级域名.根域名 host.sld.tld.root www.isshe.xyz.root abc.isshe.xyz.root 分级查询：从根域名开始，依次查询每一级域名的 NS 记录。
从根域名服务器查询顶级域名服务器的 NS 记录和 A 记录； 根域名服务器是总所周知的，不用查。 从顶级域名服务器查询次级域名服务器的 NS 记录和 A 记录； 从次级域名服务器查询主机名的 A 记录； 分级查询示例：www.isshe.xyz
dig +trace www.isshe.xyz 进行查看
列出根域名服务器： . 227343 IN NS e.</description></item><item><title>网络协议 —— ICMP</title><link>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-icmp/</link><pubDate>Sun, 16 Oct 2022 12:00:00 +0800</pubDate><guid>https://isshe.site/p/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-icmp/</guid><description>ICMP ICMP - 互联网控制消息协议（Internet Control Message Protocol） ICMP 是互联网协议族的核心协议之一。 IMCP 用于发送控制消息，提供可能发生在通信环境中的各种问题反馈。 ICMP 消息都是直接封装在一个 IP 数据包中的，因此，和 UDP 一样，ICMP 是不可靠的。 原理及技术细节 每个路由器在转发数据报的时候都会把 IP 包头中的 TTL 值减 1。 报文结构 ICMP 报头从 IP 报头的第 160 位 (20 字节) 开始：（有可选部分另算）
8bit 8bit 8bit 8bit +------+------+------+------+ | Type | Code | Checksum | +------+------+------+------+ | ID | Sequence | +------+------+------+------+ Type: ICMP 报文类型。 Code：进一步划分 ICMP 的类型；该字段用来查找产生错误的原因。 例如，ICMP 的目标不可达类型可以把这个位设为 1 至 15 等来表示不同的意思。 Checksum：校验和。 ID：ID/标识，在 Echo Reply 类型的消息中需要返回这个字段。 Sequence：序号，在 Echo Reply 类型的消息中需要返回这个字段。 报文类型 Type Code Status 描述 查询 差错 备注 0：Echo 响应 0 Echo 响应 ✓ ping 中使用 1 未分配 ✓ 保留 2 未分配 ✓ 保留 3：目的不可达 0 目标网络不可达 ✓ 1 目标主机不可达 ✓ 2 目标协议不可达 ✓ 3 目标端口不可达 ✓ 4 要求分段并 (但) 设置 DF 标记 ✓ 5 源路由失败 ✓ 6 未知的目标网络 ✓ 7 未知的目标主机 ✓ 8 源主机隔离（作废不用） ✓ 9 禁止访问的网络 ✓ 10 禁止访问的主机 ✓ 11 对特定的 TOS 网络不可达 ✓ 12 对特定的 TOS 主机不可达 ✓ 13 由于过滤 网络流量被禁止 ✓ 14 主机越权 ✓ 15 优先权终止生效 ✓ 4：源端关闭 0 弃用 源端关闭（拥塞控制） ✓ 5：重定向 0 重定向网络 ✓ 1 重定向主机 ✓ 2 基于 TOS 的网络重定向 ✓ 3 基于 TOS 的主机重定向 ✓ 6 弃用 备用主机地址 7 未分配 保留 8 0 Echo 请求 ✓ 9 0 路由通告 ✓ 10 0 路由器的发现/选择/请求 ✓ 11：超时 0 TTL 超时 ✓ 1 分片重组超时 ✓ 12：参数问题-IP 头部错误 0 IP 报文首部参数错误 ✓ 1 丢失必要选项 ✓ 2 不支持的长度 13 0 时间戳请求 ✓ 14 0 时间戳应答 ✓ 15 0 信息请求 ✓ 16 0 信息应答 ✓ 17 0 地址掩码请求 ✓ 18 0 地址掩码应答 ✓ 19 保留 因安全原因保留 20~29 保留 保留用于稳健性实验 30~39 弃用 40 Photuris, Security failures ？？？ 41 用于实验性移动协议，如 Seamoby[RFC4065] 42~255 保留 235 实验性 RFC3692 254 实验性 RFC3692 部分报文结构示例 3：目标不可达 目的地不可达由主机或其入站网关生成，以通知客户端由于某种原因目的地不可达。</description></item></channel></rss>