<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="进程 进程是操作系统中最核心的概念。
 定义：一个执行中的程序的实例。（对正在运行程序的一个抽象） 是资源分配的基本单位。 进程提供给应用程序的关键抽象：  一个独立的逻辑控制流，它提供一个假象，好像程序独占地使用处理器。 一个私有的地址空间，它提供一个假象，好像程序独占地使用存储器系统。   逻辑流(逻辑控制流）：程序计数器PC值的序列。  异常处理程序、进程、信号处理程序、线程和Java进程都是逻辑流的例子。   并发流(concurrent flow)：一个逻辑流的执行在时间上与另一个流重叠。 并发：多条流并发地执行的一般现象称为并发(concurrecy)。 多任务(multitasking)：一个进程和其他进程轮流运行的概念称为多任务。 时间片(time slice)：一个进程执行它的控制流的一部分的每一时间段。 并行流(parallel flow)：两个流运行在不同的处理器上或者不同的计算机上。 上下文(context)：内核重新启动一个被抢占的进程所需要的状态。 上下文切换：内核为每个进程维护一个上下文(context)，多任务的实现依赖上下文切换。  1）保存当前进程的上下文； 2）恢复某个先前被抢占的进程被保存的上下文； 3）将控制传递给这个新恢复的进程；    1.进程地址空间 1.1 典型进程地址空间1  典型进程地址空间1 
 代码段起始地址：  32位：0x08048000 64位：0x00400000   进程从用户模式变为内核模式的方法是：中断、故障、陷入系统调用。  1.2 典型进程地址空间2  典型进程地址空间2 
2. 进程状态 2.1 状态转换图   状态转换图   2.2 基本状态  1）运行态：进程实际占用CPU； 2）就绪态：可运行； 3）阻塞态：除非某种外部事件发生(使进程满足运行条件)，否则进程不能运行。  2.3 引入的状态：  创建状态； 终止状态； 挂起状态；（图中没有）  3."><title>操作系统 —— 进程</title>
<link rel=canonical href=https://isshe.site/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="操作系统 —— 进程">
<meta property="og:description" content="进程 进程是操作系统中最核心的概念。
 定义：一个执行中的程序的实例。（对正在运行程序的一个抽象） 是资源分配的基本单位。 进程提供给应用程序的关键抽象：  一个独立的逻辑控制流，它提供一个假象，好像程序独占地使用处理器。 一个私有的地址空间，它提供一个假象，好像程序独占地使用存储器系统。   逻辑流(逻辑控制流）：程序计数器PC值的序列。  异常处理程序、进程、信号处理程序、线程和Java进程都是逻辑流的例子。   并发流(concurrent flow)：一个逻辑流的执行在时间上与另一个流重叠。 并发：多条流并发地执行的一般现象称为并发(concurrecy)。 多任务(multitasking)：一个进程和其他进程轮流运行的概念称为多任务。 时间片(time slice)：一个进程执行它的控制流的一部分的每一时间段。 并行流(parallel flow)：两个流运行在不同的处理器上或者不同的计算机上。 上下文(context)：内核重新启动一个被抢占的进程所需要的状态。 上下文切换：内核为每个进程维护一个上下文(context)，多任务的实现依赖上下文切换。  1）保存当前进程的上下文； 2）恢复某个先前被抢占的进程被保存的上下文； 3）将控制传递给这个新恢复的进程；    1.进程地址空间 1.1 典型进程地址空间1  典型进程地址空间1 
 代码段起始地址：  32位：0x08048000 64位：0x00400000   进程从用户模式变为内核模式的方法是：中断、故障、陷入系统调用。  1.2 典型进程地址空间2  典型进程地址空间2 
2. 进程状态 2.1 状态转换图   状态转换图   2.2 基本状态  1）运行态：进程实际占用CPU； 2）就绪态：可运行； 3）阻塞态：除非某种外部事件发生(使进程满足运行条件)，否则进程不能运行。  2.3 引入的状态：  创建状态； 终止状态； 挂起状态；（图中没有）  3.">
<meta property="og:url" content="https://isshe.site/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/">
<meta property="og:site_name" content="树深时间录">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="process"><meta property="article:tag" content="操作系统"><meta property="article:tag" content="application"><meta property="article:tag" content="linux"><meta property="article:published_time" content="2022-10-16T12:23:30-03:00"><meta property="article:modified_time" content="2022-10-16T12:23:30-03:00"><meta property="og:image" content="https://isshe.site/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map.png">
<meta name=twitter:title content="操作系统 —— 进程">
<meta name=twitter:description content="进程 进程是操作系统中最核心的概念。
 定义：一个执行中的程序的实例。（对正在运行程序的一个抽象） 是资源分配的基本单位。 进程提供给应用程序的关键抽象：  一个独立的逻辑控制流，它提供一个假象，好像程序独占地使用处理器。 一个私有的地址空间，它提供一个假象，好像程序独占地使用存储器系统。   逻辑流(逻辑控制流）：程序计数器PC值的序列。  异常处理程序、进程、信号处理程序、线程和Java进程都是逻辑流的例子。   并发流(concurrent flow)：一个逻辑流的执行在时间上与另一个流重叠。 并发：多条流并发地执行的一般现象称为并发(concurrecy)。 多任务(multitasking)：一个进程和其他进程轮流运行的概念称为多任务。 时间片(time slice)：一个进程执行它的控制流的一部分的每一时间段。 并行流(parallel flow)：两个流运行在不同的处理器上或者不同的计算机上。 上下文(context)：内核重新启动一个被抢占的进程所需要的状态。 上下文切换：内核为每个进程维护一个上下文(context)，多任务的实现依赖上下文切换。  1）保存当前进程的上下文； 2）恢复某个先前被抢占的进程被保存的上下文； 3）将控制传递给这个新恢复的进程；    1.进程地址空间 1.1 典型进程地址空间1  典型进程地址空间1 
 代码段起始地址：  32位：0x08048000 64位：0x00400000   进程从用户模式变为内核模式的方法是：中断、故障、陷入系统调用。  1.2 典型进程地址空间2  典型进程地址空间2 
2. 进程状态 2.1 状态转换图   状态转换图   2.2 基本状态  1）运行态：进程实际占用CPU； 2）就绪态：可运行； 3）阻塞态：除非某种外部事件发生(使进程满足运行条件)，否则进程不能运行。  2.3 引入的状态：  创建状态； 终止状态； 挂起状态；（图中没有）  3."><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://isshe.site/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map.png">
<link rel="shortcut icon" href=/favicon/favicon-ss.svg>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YRCL8C5MTX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-YRCL8C5MTX',{anonymize_ip:!1})}</script>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>返回</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map_hu575c6395d5e84185e674e7125c58f205_133704_800x0_resize_box_3.png srcset="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map_hu575c6395d5e84185e674e7125c58f205_133704_800x0_resize_box_3.png 800w, /p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map_hu575c6395d5e84185e674e7125c58f205_133704_1600x0_resize_box_3.png 1600w" width=800 height=667 loading=lazy alt="Featured image of post 操作系统 —— 进程">
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ style=background-color:#eab3ae;color:#fff>
操作系统
</a>
</header>
<h2 class=article-title>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/>操作系统 —— 进程</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Oct 16, 2022</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
阅读时长: 2 分钟
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h1 id=进程>进程</h1>
<p>进程是操作系统中最核心的概念。</p>
<ul>
<li>定义：一个执行中的程序的实例。（对正在运行程序的一个抽象）</li>
<li>是资源分配的基本单位。</li>
<li>进程提供给应用程序的关键抽象：
<ul>
<li>一个独立的<code>逻辑控制流</code>，它提供一个假象，好像程序独占地使用处理器。</li>
<li>一个私有的<code>地址空间</code>，它提供一个假象，好像程序独占地使用存储器系统。</li>
</ul>
</li>
<li><code>逻辑流(逻辑控制流）</code>：程序计数器PC值的序列。
<ul>
<li>异常处理程序、进程、信号处理程序、线程和Java进程都是逻辑流的例子。</li>
</ul>
</li>
<li><code>并发流(concurrent flow)</code>：一个逻辑流的执行在时间上与另一个流重叠。</li>
<li><code>并发</code>：多条流并发地执行的一般现象称为并发(concurrecy)。</li>
<li><code>多任务(multitasking)</code>：一个进程和其他进程轮流运行的概念称为多任务。</li>
<li><code>时间片(time slice)</code>：一个进程执行它的控制流的一部分的每一时间段。</li>
<li><code>并行流(parallel flow)</code>：两个流运行在不同的处理器上或者不同的计算机上。</li>
<li><code>上下文(context)</code>：内核重新启动一个被抢占的进程所需要的状态。</li>
<li><code>上下文切换</code>：内核为每个进程维护一个<code>上下文(context)</code>，多任务的实现依赖上下文切换。
<ul>
<li>1）保存当前进程的上下文；</li>
<li>2）恢复某个先前被抢占的进程被保存的上下文；</li>
<li>3）将控制传递给这个新恢复的进程；</li>
</ul>
</li>
</ul>
<h2 id=1进程地址空间>1.进程地址空间</h2>
<h3 id=11-典型进程地址空间1>1.1 典型进程地址空间1</h3>
<p><figure class=gallery-image style=flex-grow:119;flex-basis:287px>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map.png data-size=553x461>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map.png width=553 height=461 srcset="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map_hu575c6395d5e84185e674e7125c58f205_133704_480x0_resize_box_3.png 480w, /p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map_hu575c6395d5e84185e674e7125c58f205_133704_1024x0_resize_box_3.png 1024w" loading=lazy alt=典型进程地址空间1>
</a>
<figcaption>典型进程地址空间1</figcaption>
</figure></p>
<ul>
<li>代码段起始地址：
<ul>
<li>32位：0x08048000</li>
<li>64位：0x00400000</li>
</ul>
</li>
<li>进程从用户模式变为内核模式的方法是：中断、故障、陷入系统调用。</li>
</ul>
<h3 id=12-典型进程地址空间2>1.2 典型进程地址空间2</h3>
<p><figure class=gallery-image style=flex-grow:89;flex-basis:214px>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map2.png data-size=313x351>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map2.png width=313 height=351 srcset="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map2_hubf952d7d7b4c15b4a5fb33d32dcdde07_39075_480x0_resize_box_3.png 480w, /p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_address_map2_hubf952d7d7b4c15b4a5fb33d32dcdde07_39075_1024x0_resize_box_3.png 1024w" loading=lazy alt=典型进程地址空间2>
</a>
<figcaption>典型进程地址空间2</figcaption>
</figure></p>
<h2 id=2-进程状态>2. 进程状态</h2>
<h3 id=21-状态转换图>2.1 状态转换图</h3>
<ul>
<li><figure class=gallery-image style=flex-grow:186;flex-basis:448px>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_status_change.png data-size=491x263>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_status_change.png width=491 height=263 srcset="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_status_change_hubac1e619861cdad4c7c1db0c8f359365_25814_480x0_resize_box_3.png 480w, /p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/process_status_change_hubac1e619861cdad4c7c1db0c8f359365_25814_1024x0_resize_box_3.png 1024w" loading=lazy alt=状态转换图>
</a>
<figcaption>状态转换图</figcaption>
</figure></li>
</ul>
<h3 id=22-基本状态>2.2 基本状态</h3>
<ul>
<li>1）运行态：进程实际占用CPU；</li>
<li>2）就绪态：可运行；</li>
<li>3）阻塞态：除非某种外部事件发生(使进程满足运行条件)，否则进程不能运行。</li>
</ul>
<h3 id=23-引入的状态>2.3 引入的状态：</h3>
<ul>
<li>创建状态；</li>
<li>终止状态；</li>
<li>挂起状态；（图中没有）</li>
</ul>
<h2 id=3-进程控制>3. 进程控制</h2>
<h3 id=31-进程创建与终止>3.1 进程创建与终止</h3>
<ul>
<li>导致<code>进程创建</code>的主要事件：
<ul>
<li>1）系统初始化；</li>
<li>2）正在运行的程序执行了创建进程的系统调用；</li>
<li>3）用户请求创建一个新进程；</li>
<li>4）一个批处理作业的初始化；</li>
</ul>
</li>
<li>导致<code>进程终止</code>的主要事件：
<ul>
<li>1）正常退出（自愿的）
<ul>
<li>A.从main返回；</li>
<li>B.调用exit；</li>
<li>C.调用_exit或_Exit;</li>
<li>D.最后一个线程从其启动例程返回；</li>
<li>E.从最后一个线程调用pthread_exit()；</li>
</ul>
</li>
<li>2）出错退出（自愿的）
<ul>
<li>调用abort</li>
</ul>
</li>
<li>3）严重错误/被其他进程杀死（非自愿）
<ul>
<li>接到终止信号；</li>
<li>最后一个线程对取消(cancellation)请求做出响应；</li>
</ul>
</li>
</ul>
</li>
<li>相关函数</li>
</ul>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=c1>// 进程创建
</span><span class=c1></span><span class=n>pid_t</span> <span class=nf>fork</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
<span class=c1>// 进程退出
</span><span class=c1>// 进行一些清理（关闭文件描述符之类的）,然后返回内核
</span><span class=c1></span><span class=kt>void</span> <span class=nf>exit</span><span class=p>(</span><span class=kt>int</span> <span class=n>status</span><span class=p>);</span>
<span class=c1>// 下面两个直接返回内核
</span><span class=c1></span><span class=kt>void</span> <span class=nf>_Exit</span><span class=p>(</span><span class=kt>int</span> <span class=n>status</span><span class=p>);</span>
<span class=kt>void</span> <span class=nf>_exit</span><span class=p>(</span><span class=kt>int</span> <span class=n>status</span><span class=p>);</span>
</code></pre></div><ul>
<li>fork失败的主要原因：
<ul>
<li>系统中已经有太多进程。</li>
<li>该实际用户ID的进程数超过了系统限制。</li>
</ul>
</li>
</ul>
<h2 id=4-守护进程>4. 守护进程</h2>
<ul>
<li>守护进程：
<ul>
<li>一种生存期长的进程。</li>
<li>后台运行；</li>
<li>没有控制终端；</li>
</ul>
</li>
</ul>
<h3 id=41-编程规则>4.1 编程规则</h3>
<ul>
<li>1）调用umask将文件模式创建屏蔽字设置为一个已知的值（通常是0）；【疑问？！】</li>
<li>2）调用fork，然后使父进程exit；</li>
<li>3）调用setsid创建一个新会话；
<ul>
<li>a）进程成为新会话的首进程；</li>
<li>b）成为一个新进程组的组长进程；</li>
<li>c）没有控制终端；</li>
</ul>
</li>
<li>4）将当前工作目录更改为根目录；</li>
<li>5）关闭不再需要的文件描述符；</li>
<li>6）[选]打开/dev/null使进程具有文件描述符0/1/2。
<ul>
<li>使所有读标准输入，写标准输出/错误输出的库例程都不会产生效果。</li>
</ul>
</li>
</ul>
<h3 id=42-示例>4.2 示例</h3>
<ul>
<li>见<a class=link href=Examples/1_daemonize.c>守护进程示例</a></li>
</ul>
<h3 id=43-守护进程的惯例>4.3 守护进程的惯例</h3>
<ul>
<li>锁文件放<code>/var/run</code>目录，命名为<code>name.pid</code>。</li>
<li>配置放<code>/etc</code>目录，命名为<code>name.conf</code>。</li>
<li>可用命令行启动。
<ul>
<li>通常由<code>/etc/rc*</code>或<code>/etc/init.d/*</code>启动。</li>
<li>守护进程终止时，应当自动重启。(<code>/etc/inittab</code>中为守护进程添加<code>respawn</code>记录项【macOS没有此文件！】)</li>
</ul>
</li>
<li>守护进程可通过SIGHUP信号，重新读取配置（当配置更新时）。</li>
</ul>
<h2 id=5-进程实现>5. 进程实现</h2>
<ul>
<li>进程表：操作系统维护的一张表格——一个结构数组。</li>
<li>进程表项：也称<code>进程控制块</code>，是<code>进程表</code>的表项。</li>
<li>典型系统中的一些关键字段：</li>
</ul>
<table>
<thead>
<tr>
<th>进程管理</th>
<th>存储管理</th>
<th>文件管理</th>
</tr>
</thead>
<tbody>
<tr>
<td>寄存器</td>
<td>正文段指针</td>
<td>根目录</td>
</tr>
<tr>
<td>程序计数器</td>
<td>数据段指针</td>
<td>工作目录</td>
</tr>
<tr>
<td>程序状态字</td>
<td>堆栈段指针</td>
<td>文件描述符</td>
</tr>
<tr>
<td>堆栈指针</td>
<td></td>
<td>用户ID</td>
</tr>
<tr>
<td>进程状态</td>
<td></td>
<td>组ID</td>
</tr>
<tr>
<td>优先级</td>
<td></td>
<td></td>
</tr>
<tr>
<td>调度参数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>进程ID</td>
<td></td>
<td></td>
</tr>
<tr>
<td>父进程</td>
<td></td>
<td></td>
</tr>
<tr>
<td>进程组</td>
<td></td>
<td></td>
</tr>
<tr>
<td>信号</td>
<td></td>
<td></td>
</tr>
<tr>
<td>&mldr;</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id=a拓展>A.拓展</h2>
<h3 id=a1-进程组>A.1 进程组</h3>
<ul>
<li>进程组：在类UNIX系统中，进程和它的所有子进程以及后裔进程共同组成一个进程组。</li>
<li>进程组相关函数:</li>
</ul>
<pre tabindex=0><code>#include &lt;unistd.h&gt;

// 获取进程组ID
pid_t getpgrp(void);
// 改变自己或其他进程的进程组
// pid == 0: 使用当前进程
// pgid== 0: pid进程的PID作为进程组ID。
int setpgid(pid_t pid, pid_t pgid);
</code></pre><ul>
<li>僵死进程/僵尸进程：终止，但未被回收的进程。
<ul>
<li>进程已经终止了，但内核仍保留它的某些状态直到父进程回收它为止。</li>
</ul>
</li>
<li>相关函数:</li>
</ul>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;sys/wait.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=n>pid_t</span> <span class=nf>waitpid</span><span class=p>(</span><span class=n>pid_t</span> <span class=n>pid</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>status</span><span class=p>,</span> <span class=kt>int</span> <span class=n>options</span><span class=p>);</span>
<span class=n>pid_t</span> <span class=nf>wait</span><span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=n>status</span><span class=p>);</span>
<span class=kt>unsigned</span> <span class=kt>int</span> <span class=nf>sleep</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>secs</span><span class=p>);</span>
<span class=kt>int</span> <span class=nf>pause</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
</code></pre></div><h3 id=a2-子进程回收方式>A.2 子进程回收方式</h3>
<ul>
<li>回收子进程的方式：用SIGCHLD信号。子进程终止时，会发送SIGCHLD信号给其父进程。
【详见<a class=link href=../2.%e4%bf%a1%e5%8f%b7/Examples/2_ex_SIGCHLD.c>ex_SIGCHLD.c</a>】</li>
</ul>
<h3 id=a3-c程序的启动和终止>A.3 C程序的启动和终止</h3>
<p><figure class=gallery-image style=flex-grow:138;flex-basis:331px>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/c_program_start_end.png data-size=653x473>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/c_program_start_end.png width=653 height=473 srcset="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/c_program_start_end_hu1c3c21029dbcbc09f3d43e0d44972160_99269_480x0_resize_box_3.png 480w, /p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/c_program_start_end_hu1c3c21029dbcbc09f3d43e0d44972160_99269_1024x0_resize_box_3.png 1024w" loading=lazy alt=C程序的启动和终止>
</a>
<figcaption>C程序的启动和终止</figcaption>
</figure></p>
<ul>
<li><strong>内核使程序执行的唯一方法：exec!</strong></li>
</ul>
<h3 id=a4-进程资源限制>A.4 进程资源限制</h3>
<ul>
<li>见《Unix环境高级编程》p175</li>
</ul>
<h3 id=a5-7个exec的关系>A.5 7个exec的关系</h3>
<p><figure class=gallery-image style=flex-grow:216;flex-basis:520px>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/7_exec_relationship.png data-size=577x266>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/7_exec_relationship.png width=577 height=266 srcset="/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/7_exec_relationship_hu4ed92d3a8b8c87444b47f80c914bafe3_46772_480x0_resize_box_3.png 480w, /p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B/7_exec_relationship_hu4ed92d3a8b8c87444b47f80c914bafe3_46772_1024x0_resize_box_3.png 1024w" loading=lazy alt=7个exec的关系>
</a>
<figcaption>7个exec的关系</figcaption>
</figure></p>
<h3 id=a6-ps命令中进程状态>A.6 ps命令中进程状态</h3>
<ul>
<li><code>R</code>: TASK_RUNNING，可执行状态。</li>
<li><code>S</code>: TASK_INTERRUPTIBLE，可中断的睡眠状态。</li>
<li><code>D</code>: TASK_UNINTERRUPTIBLE，不可中断的睡眠状态。</li>
<li><code>T</code>: TASK_STOPPED/TASK_TRACED，暂停状态或跟踪状态。</li>
<li><code>Z</code>: TASK_DEAD – EXIT_ZOMBIE，退出状态，进程成为僵尸进程。</li>
<li><code>X</code>: TASK_DEAD – EXIT_DEAD，退出状态，进程即将被销毁。</li>
</ul>
<h2 id=b疑问不懂>B.疑问/不懂</h2>
<ul>
<li>孤儿进程组?</li>
<li>文件模式创建屏蔽字是什么？有何作用？(umask()设置的那个))</li>
</ul>
<h2 id=c参考>C.参考</h2>
<ul>
<li><a class=link href=https://blog.csdn.net/i_scream_/article/details/51569355 target=_blank rel=noopener>https://blog.csdn.net/i_scream_/article/details/51569355</a></li>
<li>《Unix环境高级编程》</li>
<li>《现代操作系统》</li>
<li>《深入理解计算机系统》</li>
</ul>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/process/>process</a>
<a href=/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/>操作系统</a>
<a href=/tags/application/>application</a>
<a href=/tags/linux/>linux</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>相关文章</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E4%B9%8B-posix-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98/>
<div class=article-image>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E4%B9%8B-posix-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98/_hu884d2f2f6c651f24e84f37946b6832f5_75534_3f5d524f2a75f8ac0bbd55425636cd4e.png width=250 height=150 loading=lazy alt="Featured image of post 操作系统 —— 进程间通信之 Posix 共享内存" data-hash="md5-a9OT1bUgEeXjtsU4ofcM2Q==">
</div>
<div class=article-details>
<h2 class=article-title>操作系统 —— 进程间通信之 Posix 共享内存</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E5%8F%B7/>
<div class=article-image>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E5%8F%B7/Linux_signal.90b39cdd9bb2ca10932404bab31af250_huec7bd37c00e9f0f66a7da81ead81d61e_182649_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 操作系统 —— 信号" data-hash="md5-kLOc3ZuyyhCTJAS6sxryUA==">
</div>
<div class=article-details>
<h2 class=article-title>操作系统 —— 信号</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E4%B9%8B-systemv-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98/>
<div class=article-image>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E4%B9%8B-systemv-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98/image.07ba323945cb6f52ccc9b0f03135b1b3_hu70675371b4d01d0ec6d16ae0abb1373c_296698_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 操作系统 —— 进程间通信之 SystemV 共享内存" data-hash="md5-B7oyOUXLb1LMybDwMTWxsw==">
</div>
<div class=article-details>
<h2 class=article-title>操作系统 —— 进程间通信之 SystemV 共享内存</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E4%B9%8B-systemv-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/>
<div class=article-image>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E4%B9%8B-systemv-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/_hu498ddc20215e05cce1e1ed9d386c01d9_106974_ca324b7f4abb600546718d6087262f11.png width=250 height=150 loading=lazy alt="Featured image of post 操作系统 —— 进程间通信之 SystemV 消息队列" data-hash="md5-v9Kqae3ZN34bFhqsWEshQw==">
</div>
<div class=article-details>
<h2 class=article-title>操作系统 —— 进程间通信之 SystemV 消息队列</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%BA%BF%E7%A8%8B/>
<div class=article-image>
<img src=/p/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%BA%BF%E7%A8%8B/prethreading.dcf872567259486920712acd679c8845_hu6d86b1b4a5aabba4c58c9dd2ddcba887_57880_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 操作系统 —— 线程" data-hash="md5-3PhyVnJZSGkgcSrNZ5yIRQ==">
</div>
<div class=article-details>
<h2 class=article-title>操作系统 —— 线程</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div id=gitalk-container></div>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css>
<script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script>
<script>const gitalk=new Gitalk({clientID:"7e9427059aca5b5e1496",clientSecret:"05b62531357375142bd7b06096ec194ee4db119c",repo:"isshe.github.io",owner:"isshe",admin:["isshe"],distractionFreeMode:!1,id:md5(location.pathname)});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2023 树深时间录
</section>
<section class=powerby>
相信美好的事情即将发生。 <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">目录</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#1进程地址空间>1.进程地址空间</a>
<ol>
<li><a href=#11-典型进程地址空间1>1.1 典型进程地址空间1</a></li>
<li><a href=#12-典型进程地址空间2>1.2 典型进程地址空间2</a></li>
</ol>
</li>
<li><a href=#2-进程状态>2. 进程状态</a>
<ol>
<li><a href=#21-状态转换图>2.1 状态转换图</a></li>
<li><a href=#22-基本状态>2.2 基本状态</a></li>
<li><a href=#23-引入的状态>2.3 引入的状态：</a></li>
</ol>
</li>
<li><a href=#3-进程控制>3. 进程控制</a>
<ol>
<li><a href=#31-进程创建与终止>3.1 进程创建与终止</a></li>
</ol>
</li>
<li><a href=#4-守护进程>4. 守护进程</a>
<ol>
<li><a href=#41-编程规则>4.1 编程规则</a></li>
<li><a href=#42-示例>4.2 示例</a></li>
<li><a href=#43-守护进程的惯例>4.3 守护进程的惯例</a></li>
</ol>
</li>
<li><a href=#5-进程实现>5. 进程实现</a></li>
<li><a href=#a拓展>A.拓展</a>
<ol>
<li><a href=#a1-进程组>A.1 进程组</a></li>
<li><a href=#a2-子进程回收方式>A.2 子进程回收方式</a></li>
<li><a href=#a3-c程序的启动和终止>A.3 C程序的启动和终止</a></li>
<li><a href=#a4-进程资源限制>A.4 进程资源限制</a></li>
<li><a href=#a5-7个exec的关系>A.5 7个exec的关系</a></li>
<li><a href=#a6-ps命令中进程状态>A.6 ps命令中进程状态</a></li>
</ol>
</li>
<li><a href=#b疑问不懂>B.疑问/不懂</a></li>
<li><a href=#c参考>C.参考</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>